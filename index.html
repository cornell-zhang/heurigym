<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HeuriGym Leaderboard</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    body {
      font-family: 'Open Sans', sans-serif;
      margin: 0;
      background-color: white;
      color: #333;
      min-width: 320px; /* Minimum width to prevent layout breaking */
    }
    .header {
      text-align: center;
      padding: 2.5rem 1rem 0.5rem;
      font-size: 2.5rem;
      font-weight: 600;
    }
    .subheader {
      text-align: center;
      font-size: 1.2rem;
      color: #666;
      margin-top: 0.2rem;
      margin-bottom: 1.5rem;
    }
    .authors {
      text-align: center;
      font-size: 0.9rem;
      color: #999;
      margin-bottom: 1rem;
    }
    .links {
      text-align: center;
      margin-bottom: 1rem;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 1rem;
    }
    .links a {
      color: #666;
      text-decoration: none;
      font-size: 1.5rem;
      transition: color 0.2s;
      white-space: nowrap;
    }
    .links a:hover {
      color: #0066cc;
    }
    .section {
      max-width: 1000px;
      margin: 0 auto;
      padding: 0 1rem 2rem;
      width: 100%;
      box-sizing: border-box;
    }
    .section h2 {
      margin-top: 2rem;
      font-size: 1.5rem;
      font-weight: 600;
      color: #333;
    }
    .section p, .section code {
      font-size: 0.95rem;
      line-height: 1.6;
    }
    .leaderboard-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1.5rem;
      overflow-x: auto;
      display: block;
    }
    .leaderboard-table th, .leaderboard-table td {
      padding: 0.75rem 1rem;
      text-align: left;
      border-bottom: 1px solid #e0e0e0;
      white-space: nowrap;
    }
    .leaderboard-table th {
      background-color: #f0f0f0;
      font-weight: 600;
      cursor: pointer;
      user-select: none;
    }
    .leaderboard-table th:hover {
      background-color: #e0e0e0;
    }
    .leaderboard-table th.sort-asc::after {
      content: " â–²";
      font-size: 0.8em;
    }
    .leaderboard-table th.sort-desc::after {
      content: " â–¼";
      font-size: 0.8em;
    }
    .model-name {
      font-family: 'Courier New', monospace;
    }
    .model-name a {
      color: #0066cc;
      text-decoration: none;
    }
    .model-name a:hover {
      text-decoration: underline;
    }
    .star-note {
      color: #666;
      font-size: 0.9rem;
      margin-top: 0.5rem;
    }
    .chart-container {
      background: white;
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      box-sizing: border-box;
    }
    .chart-container h2 {
      align-self: flex-start;
      margin-bottom: 1rem;
      width: 100%;
    }
    #scatter-chart {
      display: flex;
      justify-content: center;
      width: 100%;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      padding: 0;
    }
    #scatter-chart svg {
      min-width: 800px;
      max-width: 100%;
      height: auto;
      margin: 0;
    }
    .tooltip {
      position: absolute;
      background-color: white;
      border: 1px solid #ccc;
      padding: 8px;
      font-size: 12px;
      pointer-events: none;
      opacity: 0;
    }
    .citation-box {
      background-color: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 4px;
      padding: 1rem;
      margin: 1rem 0;
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
      line-height: 1.5;
      white-space: pre-wrap;
      overflow-x: auto;
      position: relative;
    }
    .copy-button {
      position: absolute;
      top: 1rem;
      right: 1rem;
      padding: 0.25rem 0.5rem;
      background-color: #e9ecef;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.8rem;
      transition: background-color 0.2s;
    }
    .copy-button:hover {
      background-color: #dee2e6;
    }
    .citation-box code {
      display: block;
      padding: 0.5rem;
      background-color: #fff;
      border: 1px solid #dee2e6;
      border-radius: 3px;
    }
    .temperature-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 1rem;
    }
    .temp-btn {
      padding: 0.5rem 1rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      background-color: white;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }
    .temp-btn:hover {
      background-color: #f0f0f0;
    }
    .temp-btn.active {
      background-color: #0066cc;
      color: white;
      border-color: #0066cc;
    }

    /* Media queries for responsive design */
    @media screen and (max-width: 768px) {
      .header {
        font-size: 2rem;
        padding: 1.5rem 1rem 0.5rem;
      }
      .subheader {
        font-size: 1rem;
        padding: 0 1rem;
      }
      .section {
        padding: 0 1rem 1rem;
        width: 100%;
        box-sizing: border-box;
      }
      .chart-container {
        padding: 1rem 0;
        width: 100%;
        box-sizing: border-box;
      }
      .leaderboard-table {
        width: 100%;
        margin: 1.5rem 0;
      }
      .leaderboard-table th, .leaderboard-table td {
        padding: 0.5rem 0.75rem;
        font-size: 0.9rem;
      }
      .links {
        padding: 0 1rem;
        gap: 1rem;
      }
      .links a {
        font-size: 1.2rem;
      }
      .temp-btn {
        padding: 0.4rem 0.8rem;
        font-size: 0.9rem;
      }
      #scatter-chart {
        width: 100%;
        padding: 0;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        justify-content: flex-start;
      }
      #scatter-chart svg {
        min-width: 800px;
        max-width: none;
        margin: 0;
      }
      .citation-box {
        margin: 1rem;
      }
    }

    @media screen and (max-width: 480px) {
      .header {
        font-size: 1.5rem;
        padding: 1rem 1rem 0.5rem;
      }
      .subheader {
        font-size: 0.9rem;
        padding: 0 1rem;
      }
      .section {
        padding: 0 1rem 1rem;
      }
      .chart-container {
        padding: 1rem 0;
      }
      .links {
        padding: 0 1rem;
        gap: 0.75rem;
      }
      .links a {
        font-size: 1rem;
      }
      .temperature-buttons {
        gap: 0.5rem;
        padding: 0 1rem;
      }
      .temp-btn {
        padding: 0.3rem 0.6rem;
        font-size: 0.8rem;
      }
      .leaderboard-table th, .leaderboard-table td {
        padding: 0.5rem;
      }
      .citation-box {
        margin: 1rem;
      }
      p {
        padding: 0 1rem;
      }
      #scatter-chart {
        width: 100%;
        padding: 0;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        justify-content: flex-start;
      }
      #scatter-chart svg {
        min-width: 800px;
        max-width: none;
        margin: 0;
      }
    }

    /* Media query for screens where plot needs to be scrollable */
    @media screen and (max-width: 900px) {
      #scatter-chart {
        justify-content: flex-start;
      }
      #scatter-chart svg {
        max-width: none;
      }
    }
  </style>
</head>
<body>
  <div class="header">HeuriGym Leaderboard</div>
  <div class="subheader">An Agentic Benchmark for LLM-Crafted Heuristics in Combinatorial Optimization</div>
  <div class="links">
    <a href="https://github.com/cornell-zhang/heurigym" target="_blank" title="GitHub"><i class="fab fa-github"></i> Github</a>
    <a href="https://arxiv.org/abs/2506.07972" target="_blank" title="arXiv"><svg id="logomark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17.732 24.269" width="22" height="22" style="vertical-align: middle; margin-right: 2px;"><g id="tiny"><path d="M573.549,280.916l2.266,2.738,6.674-7.84c.353-.47.52-.717.353-1.117a1.218,1.218,0,0,0-1.061-.748h0a.953.953,0,0,0-.712.262Z" transform="translate(-566.984 -271.548)" fill="#bdb9b4"/><path d="M579.525,282.225l-10.606-10.174a1.413,1.413,0,0,0-.834-.5,1.09,1.09,0,0,0-1.027.66c-.167.4-.047.681.319,1.206l8.44,10.242h0l-6.282,7.716a1.336,1.336,0,0,0-.323,1.3,1.114,1.114,0,0,0,1.04.69A.992.992,0,0,0,571,293l8.519-7.92A1.924,1.924,0,0,0,579.525,282.225Z" transform="translate(-566.984 -271.548)" fill="#b31b1b"/><path d="M584.32,293.912l-8.525-10.275,0,0L573.53,280.9l-1.389,1.254a2.063,2.063,0,0,0,0,2.965l10.812,10.419a.925.925,0,0,0,.742.282,1.039,1.039,0,0,0,.953-.667A1.261,1.261,0,0,0,584.32,293.912Z" transform="translate(-566.984 -271.548)" fill="#bdb9b4"/></g></svg> ArXiv</a>
    <a href="https://huggingface.co/datasets/heurigen/heurigen-data" target="_blank" title="Hugging Face">ðŸ¤— Dataset</a>
  </div>

  <div class="section chart-container">
    <h2>ðŸ“ˆ Overall Performance</h2>
    <div class="temperature-buttons" style="margin-bottom: 1rem;">
      <button class="temp-btn active" data-temp="0">T=0</button>
      <button class="temp-btn" data-temp="0.5">T=0.5</button>
      <button class="temp-btn" data-temp="1.0">T=1.0</button>
    </div>
    <div id="scatter-chart"></div>
    <p style="color: #666; font-size: 0.9rem; margin-top: 1rem; text-align: left;">
      Note: Yield and QYI values are weighted across the problem sets. Quality is calculated as (QYI * Yield) / (2 * Yield - QYI) since weighted QYI is not the harmonic mean of weighted Yield and weighted Quality.
    </p>
  </div>

  <div class="section">
    <h2>ðŸ“Š Leaderboard (<span id="current-temp">T=0</span>)</h2>
    <table class="leaderboard-table" id="leaderboard">
      <thead>
        <tr>
          <th data-column="Rank">Rank</th>
          <th data-column="Model">Model</th>
          <th data-column="Weighted_Yield">Weighted Yield</th>
          <th data-column="Weighted_Quality">Weighted Quality</th>
          <th data-column="Weighted_QYI">Weighted QYI</th>
          <th data-column="Cost">Cost ($)</th>
          <th data-column="Release_Date">Release Date</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <p style="color: #666; font-size: 0.9rem; margin-top: 1rem;">
      Note: All Yield, Quality, and QYI values are weighted across the problem sets in this table.
    </p>
    <p class="star-note">
      * GPT-o4-mini:high was measured under T=1 since o-series models only support T=1.
    </p>

    <h2>ðŸ“š Citation</h2>
    <div class="citation-box">@article{chen2025heurigym,
    title={HeuriGym: An Agentic Benchmark for LLM-Crafted Heuristics in Combinatorial Optimization},
    author={Hongzheng Chen and Yingheng Wang and Yaohui Cai and Hins Hu and Jiajie Li and Shirley Huang and Chenhui Deng and Rongjian Liang and Shufeng Kong and Haoxing Ren and Samitha Samaranayake and Carla P. Gomes and Zhiru Zhang},
    journal={arXiv preprint arXiv:2506.07972},
    year={2025}
}<button class="copy-button" onclick="copyCitation()">Copy</button></div>
  </div>

  <script>
    const width = 800, height = 400, margin = { top: 20, right: 60, bottom: 50, left: 60 };
    let currentTemperature = 0;
    let performanceData = null;
    let metadata = null;

    // Function to load data for a specific temperature
    async function loadData(temperature) {
      const tempFile = `overall_qyi_t${temperature}.csv`;
      try {
        performanceData = await d3.csv(tempFile);
        updateVisualization();
      } catch (error) {
        console.error(`Error loading data for temperature ${temperature}:`, error);
        // If data file doesn't exist, show a message
        if (error.status === 404) {
          alert(`Data for temperature ${temperature} is not available yet.`);
          // Reset to previous temperature
          const prevTemp = currentTemperature;
          currentTemperature = temperature;
          updateTemperatureButtons();
          currentTemperature = prevTemp;
          updateTemperatureButtons();
        }
      }
    }

    // Function to update the visualization
    function updateVisualization() {
      if (!performanceData || !metadata) return;

      // Clear existing visualization
      d3.select("#scatter-chart svg").remove();
      
      // Create new SVG
      const svg = d3.select("#scatter-chart")
        .append("svg")
        .attr("width", width)
        .attr("height", height);

      const x = d3.scaleLinear().domain([0.2, 1]).range([margin.left, width - margin.right]);
      const y = d3.scaleLinear().domain([0.2, 1]).range([height - margin.bottom, margin.top]);

      // Add grid lines
      const xGrid = d3.axisBottom(x)
        .ticks(10)
        .tickSize(-(height - margin.top - margin.bottom))
        .tickFormat("");

      const yGrid = d3.axisLeft(y)
        .ticks(10)
        .tickSize(-(width - margin.left - margin.right))
        .tickFormat("");

      svg.append("g")
        .attr("class", "grid")
        .attr("transform", `translate(0,${height - margin.bottom})`)
        .call(xGrid)
        .attr("stroke", "#e0e0e0")
        .attr("stroke-opacity", 0.3)
        .attr("stroke-dasharray", "2,2");

      svg.append("g")
        .attr("class", "grid")
        .attr("transform", `translate(${margin.left},0)`)
        .call(yGrid)
        .attr("stroke", "#e0e0e0")
        .attr("stroke-opacity", 0.3)
        .attr("stroke-dasharray", "2,2");

      svg.append("g")
        .attr("transform", `translate(0,${height - margin.bottom})`)
        .call(d3.axisBottom(x))
        .append("text")
        .attr("x", width / 2)
        .attr("y", 40)
        .attr("fill", "black")
        .attr("text-anchor", "middle")
        .attr("font-size", "14px")
        .text("Weighted Yield");

      svg.append("g")
        .attr("transform", `translate(${margin.left},0)`)
        .call(d3.axisLeft(y))
        .append("text")
        .attr("transform", "rotate(-90)")
        .attr("x", -height / 2)
        .attr("y", -40)
        .attr("fill", "black")
        .attr("text-anchor", "middle")
        .attr("font-size", "14px")
        .text("Quality");

      // Style the axis ticks
      svg.selectAll(".tick text")
        .attr("font-size", "12px");

      const tooltip = d3.select("body")
        .append("div")
        .attr("class", "tooltip");

      const qyiLevels = [0.8, 0.6, 0.4];
      
      qyiLevels.forEach(qyi => {
        const curve = d3.range(0.01, 1.01, 0.01).map(yieldVal => {
          const qualityVal = (qyi * yieldVal) / (2 * yieldVal - qyi);
          return qualityVal >= 0 && qualityVal <= 1 ? [yieldVal, qualityVal] : null;
        }).filter(d => d);

        svg.append("path")
          .datum(curve)
          .attr("fill", "none")
          .attr("stroke", "#aaa")
          .attr("stroke-dasharray", "4 2")
          .attr("stroke-width", 1)
          .attr("d", d3.line().x(d => x(d[0])).y(d => y(d[1])));

        svg.append("text")
          .attr("x", x(curve[curve.length - 1][0]) - 10)
          .attr("y", y(curve[curve.length - 1][1]) + 5)
          .text(`QYI=${qyi}`)
          .attr("font-size", "14px")
          .attr("fill", "#777");
      });

      // Combine the data
      const data = performanceData.map(d => {
        const meta = metadata.find(m => m.Model === d.Model);
        const originalQuality = +d.Weighted_Quality;
        const yield = +d.Weighted_Yield;
        const qyi = +d.Weighted_QYI;
        // Calculate quality for scatter plot using the formula
        const calculatedQuality = (qyi * yield) / (2 * yield - qyi);
        return {
          ...d,
          Weighted_Yield: yield,
          Weighted_Quality: originalQuality, // Keep original quality for table
          Calculated_Quality: calculatedQuality, // Add calculated quality for scatter plot
          Weighted_QYI: qyi,
          Cost: +d.Cost,
          URL: meta ? meta.URL : "#",
          Release_Date: meta ? new Date(meta.Release_Date) : new Date()
        };
      });

      let currentSort = { column: 'Weighted_QYI', direction: 'desc' };

      function sortData() {
        data.sort((a, b) => {
          let comparison = 0;
          if (currentSort.column === 'Model') {
            comparison = a[currentSort.column].localeCompare(b[currentSort.column]);
          } else if (currentSort.column === 'Release_Date') {
            comparison = a[currentSort.column] - b[currentSort.column];
          } else {
            comparison = a[currentSort.column] - b[currentSort.column];
          }
          return currentSort.direction === 'asc' ? comparison : -comparison;
        });
        updateTable();
      }

      function updateTable() {
        const tbody = d3.select("#leaderboard tbody");
        tbody.selectAll("tr").remove();
        
        data.forEach((d, i) => {
          const row = tbody.append("tr");
          row.append("td").text(i + 1);
          const modelCell = row.append("td").attr("class", "model-name");
          const modelLink = modelCell.append("a")
            .attr("href", d.URL)
            .attr("target", "_blank")
            .text(d.Model);
          if (d.Model === "GPT-o4-mini:high") {
            modelLink.append("span").text(" *");
          }
          row.append("td").text(d.Weighted_Yield.toFixed(3));
          row.append("td").text(d.Weighted_Quality.toFixed(3));
          row.append("td").text(d.Weighted_QYI.toFixed(3));
          row.append("td").text(d.Cost.toFixed(2));
          row.append("td").text(d.Release_Date.toLocaleDateString());
        });
      }

      // Add click handlers to table headers
      d3.selectAll("#leaderboard th").on("click", function() {
        const column = this.getAttribute("data-column");
        if (currentSort.column === column) {
          currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
        } else {
          currentSort.column = column;
          currentSort.direction = 'asc';
        }
        
        // Update sort indicators
        d3.selectAll("#leaderboard th")
          .classed("sort-asc", false)
          .classed("sort-desc", false);
        d3.select(this)
          .classed(`sort-${currentSort.direction}`, true);
        
        sortData();
      });

      // Initial sort
      sortData();

      const color = d3.scaleOrdinal(d3.schemeTableau10)
        .domain(data.map(d => d.Model));

      svg.selectAll("circle")
        .data(data)
        .enter()
        .append("circle")
        .attr("cx", d => x(d.Weighted_Yield))
        .attr("cy", d => y(d.Calculated_Quality)) // Use calculated quality for y-position
        .attr("r", 6)
        .style("fill", d => color(d.Model))
        .style("stroke", "#333")
        .on("mouseover", function (event, d) {
          tooltip.transition().duration(100).style("opacity", 1);
          tooltip.html(`<strong>${d.Model}</strong><br>Yield: ${d.Weighted_Yield.toFixed(3)}<br>Quality: ${d.Weighted_Quality.toFixed(3)}<br>QYI: ${d.Weighted_QYI.toFixed(3)}`)
            .style("left", (event.pageX + 10) + "px")
            .style("top", (event.pageY - 28) + "px");
        })
        .on("mouseout", function () {
          tooltip.transition().duration(200).style("opacity", 0);
        });

      // Update the leaderboard title
      document.getElementById("current-temp").textContent = `T=${currentTemperature}`;
    }

    // Function to update temperature buttons
    function updateTemperatureButtons() {
      document.querySelectorAll('.temp-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.temp == currentTemperature);
      });
    }

    // Add click handlers for temperature buttons
    document.querySelectorAll('.temp-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const newTemp = parseFloat(btn.dataset.temp);
        if (newTemp !== currentTemperature) {
          currentTemperature = newTemp;
          updateTemperatureButtons();
          // Update the leaderboard title immediately
          document.getElementById("current-temp").textContent = `T=${currentTemperature}`;
          loadData(currentTemperature);
        }
      });
    });

    // Initial data loading
    d3.csv("model_metadata.csv").then(data => {
      metadata = data;
      loadData(currentTemperature);
    });

    function copyCitation() {
      const citationText = `@article{chen2025heurigym,
  title={HeuriGym: An Agentic Benchmark for LLM-Crafted Heuristics in Combinatorial Optimization},
  author={Hongzheng Chen and Yingheng Wang and Yaohui Cai and Hins Hu and Jiajie Li and Shirley Huang and Chenhui Deng and Rongjian Liang and Shufeng Kong and Haoxing Ren and Samitha Samaranayake and Carla P. Gomes and Zhiru Zhang},
  journal={arXiv preprint arXiv:2506.07972},
  year={2025}
}`;
      navigator.clipboard.writeText(citationText).then(() => {
        const button = document.querySelector('.copy-button');
        const originalText = button.textContent;
        button.textContent = 'Copied!';
        setTimeout(() => {
          button.textContent = originalText;
        }, 2000);
      });
    }
  </script>
</body>
</html>
