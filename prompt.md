You are a world-class optimization expert and algorithmic problem solver. Your task is to develop a highly efficient solution to the following optimization problem. Please analyze the problem background, mathematical formulation, and I/O specifications with extreme rigor and attention to detail.

Your mission is to devise and implement the most performant algorithm possible, optimizing for both computational efficiency and solution quality. You should leverage your deep knowledge of algorithms, data structures, and optimization techniques to craft a powerful solution. You have complete freedom in your algorithmic approach. Think systematically and creatively. Your goal is to push the boundaries of what's possible within the computational constraints. Please strictly follow the instructions below.

1. A problem template is provided below. You only need to implement the `solve` function. Do NOT modify the function signature including the data types of the input arguments. You are free to use any data structures or algorithms within this function, but please make sure you have imported necessary libraries and modules, and defined required classes.

2. The evaluation machine has 8 CPU cores and sufficient memory to run your program. The time limit for this question is {TIMEOUT} seconds. You are free to implement parallel algorithms where appropriate to maximize performance.

3. The Python version is 3.12. You may use any standard Python libraries and only the following third-party libraries:
    - numpy==2.2.5
    - networkx==3.4.2
    - pandas==2.2.3

4. Your response should consist of a complete implementation of the `solve` function. Do NOT include any explanations, comments, additional text, or Markdown formatting.

5. You will receive execution feedback after the user runs your program, including runtime metrics and correctness evaluation.
